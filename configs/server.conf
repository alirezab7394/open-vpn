# OpenVPN Server Configuration
# High-Performance Setup for Ubuntu VPS

# Network settings
port 1194
proto udp
dev tun

# Certificates and keys
ca pki/ca.crt
cert pki/issued/server.crt
key pki/private/server.key
dh pki/dh.pem
tls-crypt pki/ta.key

# Server network
server 10.8.0.0 255.255.255.0
ifconfig-pool-persist pki/ipp.txt

# Routing
push "redirect-gateway def1 bypass-dhcp"
push "dhcp-option DNS 8.8.8.8"
push "dhcp-option DNS 8.8.4.4"
push "dhcp-option DNS 1.1.1.1"

# Performance optimizations
fast-io
sndbuf 0
rcvbuf 0
push "sndbuf 393216"
push "rcvbuf 393216"
txqueuelen 1000

# Security settings
cipher AES-128-GCM
auth SHA256
tls-version-min 1.2
tls-cipher TLS-ECDHE-RSA-WITH-AES-128-GCM-SHA256
remote-cert-tls client

# Connection settings
keepalive 10 120
persist-key
persist-tun
user nobody
group nogroup

# Logging
log-append /var/log/openvpn/server.log
status /var/log/openvpn/status.log
verb 3
mute 20

# Performance tweaks
topology subnet
client-config-dir /etc/openvpn/ccd

# Compression (disabled for performance)
compress

# Management interface
management 0.0.0.0 2080

# Exit notification
explicit-exit-notify 1

# Additional security
script-security 2
client-connect /etc/openvpn/connect.sh
client-disconnect /etc/openvpn/disconnect.sh

# Maximum clients
max-clients 100

# Duplicate CN (allow multiple clients with same certificate)
duplicate-cn

# Enable client-to-client communication
client-to-client

# Ping settings
ping 10
ping-restart 120
ping-timer-rem

# Replay protection
replay-window 64

# Network topology
topology subnet 